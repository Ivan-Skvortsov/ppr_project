{% extends 'base.html' %}
{% block content %}
  <form method="post" action="{% url 'reports:apply_actions' %}">
    {% csrf_token %}
    {% regroup schedule_plan by equipment_type.facility  as facility_list %}
      <!-- Заголовок таблицы -->
        <table class="table align-middle" >
          <thead>
            <tr>
              <th style="width: 5%" scope="col">#</th>
              <th style="width: 10%" scope="col">Тип ТО</th>
              <th style="width: 70%" scope="col">Наименование оборудования</th>
              <th style="width: 5%" scope="col">Журнал допуска заполнен</th>
              <th style="width: 5%" scope="col">Журнал ТО заполнен</th>
              <th style="width: 5%" scope="col">Работа выполнена</th>
            </tr>
          </thead>
        <tbody>
        {% for facility in facility_list %}
          <!-- Наименование объекта  -->
          <tr>
            <td class="text-center" colspan="6"><h3>{{ facility.grouper }}</h3></td>
          </tr>
          {% for entry in facility.list %}
           <!-- Строки таблицы -->
            <tr {% if entry.date_completed %}class="table-success"{% endif %}>
              <td>
                <div class="form-check form-switch">
                  <input type="checkbox" name="selected_schedule" value="{{ entry.pk }}" class="form-check-input">
                </div>
              </td>
              <td>{{ entry.maintenance_type }}</td>
              <td>{{ entry.equipment_type }}</td>
              <td><input type="checkbox" class="form-check-input" disabled {% if entry.access_journal_filled %} checked {% endif %}></td>
              <td><input type="checkbox" class="form-check-input" disabled {% if entry.result_journal_filled %} checked {% endif %}></td>
              <td><input type="checkbox" class="form-check-input" disabled {% if entry.date_completed %} checked {% endif %}></td>
            </tr>
            {% endfor %}
          {% endfor %}
        </tbody>
        </table>
        
   <div class="col-auto">
         <select name='selected_action' class="form-select">
            <option selected>Пометить выбранные работы:</option>
            <option value="1">Журнал допуска заполнен</option>
            <option value="2">Журнал ТО заполнен</option>
            <option value="3">Работа выполнена</option>
            <option value="4">Работа НЕ выполнена</option>
         </select>
         <button type="submit" class="btn btn-primary mb-3">Сохранить</button>
   </div>

   {{ form.employee1 }}
   {{ form.employee2 }}
   {{ form.employee3 }}

   </form>

   
{% endblock content %}
