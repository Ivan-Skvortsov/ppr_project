{% extends 'base.html' %}
{% block content %}
   <form method="post" action="{% url 'reports:apply_actions' %}">
   {% csrf_token %}

   {% regroup schedule_plan by equipment_type.facility  as facility_list %}
   {% for facility in facility_list %}
     <h3>{{ facility.grouper }}</h3>
     {% for entry in facility.list %}
      {% comment %} <thead>
            <tr>
               <th scope="col">#</th>
               <th scope="col">Тип ТО</th>
               <th scope="col">Наименование оборудования</th>
               <th scope="col">Журнал допуска заполнен</th>
               <th scope="col">Журнал ТО заполнен</th>
               <th scope="col">Работа выполнена</th>
            </tr>
         </thead> {% endcomment %}
      <table class="table">
         <tbody>
           <tr {% if entry.date_completed %}class="table-success"{% endif %}>
            <td style="width: 5%">
               <div class="form-check form-switch">
                  <input type="checkbox" name="selected_schedule" value="{{ entry.pk }}" class="form-check-input">
               </div>
            </td>
            <td style="width: 10%">{{ entry.maintenance_type }}</td>
            <td style="width: 70%">{{ entry.equipment_type }}</td>
            <td style="width: 5%"><input type="checkbox" class="form-check-input" disabled {% if entry.access_journal_filled %} checked {% endif %}></td>
            <td style="width: 5%"><input type="checkbox" class="form-check-input" disabled {% if entry.result_journal_filled %} checked {% endif %}></td>
            {% comment %} <td style="width: 5%"><input type="checkbox" class="form-check-input" disabled {% if entry.date_completed %} checked {% endif %}></td> {% endcomment %}
            <td style="width: 5%">{{ entry.date_completed }}</td>
           </tr>
         </tbody>
       </table>
      {% endfor %}
   {% endfor %}
   <div class="col-auto">
         <select name='selected_action' class="form-select">
            <option selected>Пометить выбранные работы:</option>
            <option value="1">Журнал допуска заполнен</option>
            <option value="2">Журнал ТО заполнен</option>
            <option value="3">Работа выполнена</option>
            <option value="4">Работа НЕ выполнена</option>
         </select>
         <button type="submit" class="btn btn-primary mb-3">Сохранить</button>
   </div>
   </form>
{% endblock content %}
